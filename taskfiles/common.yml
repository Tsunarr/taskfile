---
version: "3"

vars:
  TASK_REPO_URL: "https://raw.githubusercontent.com/Tsunarr/taskfile/refs/heads"
tasks:
  init:
    silent: true
    cmds:
      # download common taskfile dependencies
      - task: download:init:git
      - task: download:init:python3
      - task: download:init:commitizen
      - task: download:init:bruno
      - task: download:megalinter

  download:common:local:
    internal: true
    dir: .
    status:
      - ls common
    cmds:
      - mkdir -p common

  download:local-init:
    internal: true
    dir: ./common
    deps:
      - download:common:local
    status:
      - ls init
    cmds:
      - mkdir -p init

  download:init:git:
    internal: true
    dir: ./common/init
    deps:
      - download:local-init
    status:
      - ls git.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_GIT}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/git.yml;
        else /bin/true;
        fi

  download:init:python3:
    internal: true
    dir: ./common/init
    deps:
      - download:local-init
    status:
      - ls python3.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_PYTHON3}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/python3.yml;
        else /bin/true;
        fi

  download:init:commitizen:
    internal: true
    dir: ./common/init
    deps:
      - download:local-init
    status:
      - ls commitizen.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_COMMITIZEN}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/commitizen.yml;
        else /bin/true;
        fi

  download:init:bruno:
    internal: true
    dir: ./common/init
    deps:
      - download:local-init
    status:
      - ls bruno.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_BRUNO}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/bruno.yml;
        else /bin/true;
        fi

  download:megalinter:
    internal: true
    dir: ./common
    deps:
      - download:common:local
    status:
      - ls megalinter.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_MEGALINTER}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/megalinter.yml;
        else /bin/true;
        fi

  download:node:
    internal: true
    dir: ./common
    deps:
      - download:common:local
    status:
      - ls node.yml
    cmds:
      - |
        if [[ '{{.TASK_INIT_NODE}}' == 'true' ]] ; then
          wget {{.TASK_REPO_URL}}/{{.TASK_REPO_TAG}}/taskfiles/init/node.yml;
        else /bin/true;
        fi
